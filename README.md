# google-ai-studio-manager
在使用 Google AI Studio 进行长文本对话或复杂 Prompt 调试时，原生的历史记录难以管理，且无法批量清理特定的对话节点。本项目通过注入一个轻量级的悬浮面板，接管了页面右侧的时间轴数据，提供了一个直观、纯净且功能强大的对话管理界面。
# Google AI Studio Manager

一个针对 [Google AI Studio](https://aistudio.google.com/) 的浏览器辅助工具。

在使用 Google AI Studio 进行长文本对话或复杂 Prompt 调试时，原生的历史记录难以管理，且无法批量清理特定的对话节点。本项目通过注入一个轻量级的悬浮面板，接管了页面右侧的时间轴数据，提供了一个直观、纯净且功能强大的对话管理界面。
# Google AI Studio Manager

当前版本：**v1.0**

## 核心功能

### 1. 悬浮窗交互
*   **非侵入式设计**：默认以小圆球形态悬浮于页面右下角，点击即可展开管理面板。
*   **物理拖拽与吸附**：支持随意拖拽悬浮球位置，松手后自动吸附至屏幕边缘，不遮挡主要工作区。
*   **Shadow DOM 隔离**：使用 Shadow DOM 封装 UI，确保插件样式不污染 Google AI Studio 原生界面，同时支持跟随浏览器的深色/浅色模式。

### 2. 纯净对话列表
*   **只看用户输入**：基于白名单机制扫描 DOM，列表仅显示用户的 Prompt 和附件信息。
*   **屏蔽干扰**：自动过滤 AI 的思考过程（Thought Process）、回复内容以及单纯的代码文件名元数据，确保列表内容简洁可读。
*   **附件识别**：自动计算并标记每个对话节点中的图片或文件数量。

### 3. 搜索与定位 (v1.0 新增)
*   **关键词搜索**：在面板顶部提供了搜索框，支持实时过滤对话列表，帮助用户在几十轮的长对话中快速找到特定的 Prompt 节点。
*   **视口同步**：打开面板时，自动高亮并滚动到当前屏幕正在阅读的对话节点。
*   **一键到底**：提供悬浮按钮，支持一键跳转至对话流的最底部。

### 4. 强力批量删除
*   **连坐机制**：勾选一个用户节点，程序会自动识别并关联其后续的所有元素（包括 AI 思考、AI 回复、错误提示等）。
*   **DOM 操控**：解决了 Angular 框架下删除按钮懒加载的问题。通过模拟 Focus 事件强制唤醒隐藏的菜单按钮，通过识别图标特征定位删除选项，实现了稳定的批量删除功能。

### 5. 数据持久化
*   **内容指纹**：使用文本内容的 Hash 值作为唯一标识。即使刷新页面导致 DOM ID 变化，用户对特定节点的“星标”状态依然能够保留。

## 安装与使用

### 方式一：加载已解压的扩展程序 (Chrome/Edge)
1.  下载本项目代码至本地。
2.  打开浏览器的扩展程序管理页面 (`chrome://extensions/` 或 `edge://extensions/`)。
3.  开启“开发者模式”。
4.  点击“加载已解压的扩展程序”，选择项目根目录。
5.  刷新 Google AI Studio 页面即可看到右下角的悬浮球。

### 方式二：油猴脚本 (Tampermonkey)
*本项目代码结构支持直接移植为 UserScript。*
1.  新建油猴脚本。
2.  将 `content.js` 中的逻辑适配到脚本中（需替换 storage API）。
3.  保存并启用。

## 技术实现细节

*   **DOM 扫描**：不直接遍历聊天气泡，而是通过解析右侧时间轴 (`.prompt-scrollbar-item`) 的 `aria-controls` 属性获取锚点，以此确定对话区间。
*   **样式隔离**：全部 UI 注入在 Shadow Root 下，防止 CSS 冲突。
*   **删除逻辑**：采用倒序删除策略（先删模型回复，再删用户提问），防止 DOM 索引塌陷。

## 免责声明

本项目仅供学习和个人辅助使用，与 Google 官方无关。请在使用批量删除功能前确保数据已备份。
